<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <h:head>
        <title>Pedido - CouxChiken</title>
    </h:head>

    <h:body>
        <h:form id="formPedido">

            <p:growl id="mensagens" showDetail="true" life="4000"/>

            <h3 style="margin-top:20px;">Seus Dados</h3>
            <p:panelGrid columns="2" columnClasses="label-col,input-col" style="width:100%; gap:10px;">
                <p:outputLabel for="nome" value="Nome:"/>
                <p:inputText id="nome" value="#{pedidoBean.pedido.nome}" required="true" style="width:100%"/>

                <p:outputLabel for="telefone" value="Telefone:"/>
                <p:inputMask id="telefone" value="#{pedidoBean.pedido.telefone}" mask="(99) 99999-9999" required="true" style="width:100%"/>

                <p:outputLabel for="endereco" value="Endereço:"/>
                <p:inputTextarea id="endereco" value="#{pedidoBean.pedido.endereco}" autoResize="true" required="true" style="width:100%"/>
            </p:panelGrid>

            <p:accordionPanel multiple="false" activeIndex="">

                <!-- Hamburgueres -->
                <p:tab title="Hambúrgueres">
                    <p:dataTable id="dtHamburguer" value="#{pedidoBean.hamburgueres}" var="item" styleClass="tabela-produtos">
                        <p:column headerText="Imagem">
                            <p:graphicImage value="#{item.imagem}" style="max-width:70px; border-radius:6px"/>
                        </p:column>
                        <p:column headerText="Nome">#{item.nome}</p:column>
                        <p:column headerText="Descrição">#{item.descricao}</p:column>
                        <p:column headerText="Preço">
                            <h:outputText value="#{item.preco}">
                                <f:convertNumber pattern="R$ 00.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Qtd">
                            <p:spinner id="spinnerQtd"
                                       value="#{item.quantidade}"
                                       min="0" max="20"
                                       widgetVar="spinner_#{item.nome}"/>
                        </p:column>
                        <p:column headerText="Ações">
                            <p:commandButton value="Adicionar"
                                             actionListener="#{pedidoBean.adicionarItem(item)}"
                                             process="@this spinnerQtd"
                                             update=":formPedido:dtHamburguer :formPedido:mensagens :formPedido:resumoPedido"
                                             oncomplete="spinner_#{item.nome}.setValue(0)"/>
                        </p:column>
                    </p:dataTable>
                </p:tab>

                <!-- Hambúrgueres Artesanais -->
                <p:tab title="Hambúrgueres Artesanais">
                    <p:dataTable id="dtHamburguerArtesanal" value="#{pedidoBean.hamburgueresArtesanais}" var="item" styleClass="tabela-produtos">
                        <p:column headerText="Imagem">
                            <p:graphicImage value="#{item.imagem}" style="max-width:70px; border-radius:6px"/>
                        </p:column>
                        <p:column headerText="Nome">#{item.nome}</p:column>
                        <p:column headerText="Descrição">#{item.descricao}</p:column>
                        <p:column headerText="Preço">
                            <h:outputText value="#{item.preco}">
                                <f:convertNumber pattern="R$ 00.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Qtd">
                            <p:spinner id="spinnerQtd"
                                       value="#{item.quantidade}"
                                       min="0" max="20"
                                       widgetVar="spinner_#{item.nome}"/>
                        </p:column>
                        <p:column headerText="Ações">
                            <p:commandButton value="Adicionar"
                                             actionListener="#{pedidoBean.adicionarItem(item)}"
                                             process="@this spinnerQtd"
                                             update=":formPedido:dtHamburguerArtesanal :formPedido:mensagens :formPedido:resumoPedido"
                                             oncomplete="spinner_#{item.nome}.setValue(0)"/>
                        </p:column>
                    </p:dataTable>
                </p:tab>

                <!-- Batatas -->
                <p:tab title="Batatas">
                    <p:dataTable id="dtBatatas" value="#{pedidoBean.batatas}" var="item" styleClass="tabela-produtos">
                        <p:column headerText="Imagem">
                            <p:graphicImage value="#{item.imagem}" style="max-width:70px; border-radius:6px"/>
                        </p:column>
                        <p:column headerText="Nome">#{item.nome}</p:column>
                        <p:column headerText="Descrição">#{item.descricao}</p:column>
                        <p:column headerText="Preço">
                            <h:outputText value="#{item.preco}">
                                <f:convertNumber pattern="R$ 00.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Qtd">
                            <p:spinner id="spinnerQtd"
                                       value="#{item.quantidade}"
                                       min="0" max="20"
                                       widgetVar="spinner_#{item.nome}"/>
                        </p:column>
                        <p:column headerText="Ações">
                            <p:commandButton value="Adicionar"
                                             actionListener="#{pedidoBean.adicionarItem(item)}"
                                             process="@this spinnerQtd"
                                             update=":formPedido:dtBatatas :formPedido:mensagens :formPedido:resumoPedido"
                                             oncomplete="spinner_#{item.nome}.setValue(0)"/>
                        </p:column>
                    </p:dataTable>
                </p:tab>

                <!-- Cachorros Quente -->
                <p:tab title="Cachorros-Quente">
                    <p:dataTable id="dtCachorroQuente" value="#{pedidoBean.cachorrosQuente}" var="item" styleClass="tabela-produtos">
                        <p:column headerText="Imagem">
                            <p:graphicImage value="#{item.imagem}" style="max-width:70px; border-radius:6px"/>
                        </p:column>
                        <p:column headerText="Nome">#{item.nome}</p:column>
                        <p:column headerText="Descrição">#{item.descricao}</p:column>
                        <p:column headerText="Preço">
                            <h:outputText value="#{item.preco}">
                                <f:convertNumber pattern="R$ 00.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Qtd">
                            <p:spinner id="spinnerQtd"
                                       value="#{item.quantidade}"
                                       min="0" max="20"
                                       widgetVar="spinner_#{item.nome}"/>
                        </p:column>
                        <p:column headerText="Ações">
                            <p:commandButton value="Adicionar"
                                             actionListener="#{pedidoBean.adicionarItem(item)}"
                                             process="@this spinnerQtd"
                                             update=":formPedido:dtCachorroQuente :formPedido:mensagens :formPedido:resumoPedido"
                                             oncomplete="spinner_#{item.nome}.setValue(0)"/>
                        </p:column>
                    </p:dataTable>
                </p:tab>

                <!-- Pastéis -->
                <p:tab title="Pastéis">
                    <p:dataTable id="dtPasteis" value="#{pedidoBean.pasteis}" var="item" styleClass="tabela-produtos">
                        <p:column headerText="Imagem">
                            <p:graphicImage value="#{item.imagem}" style="max-width:70px; border-radius:6px"/>
                        </p:column>
                        <p:column headerText="Nome">#{item.nome}</p:column>
                        <p:column headerText="Descrição">#{item.descricao}</p:column>
                        <p:column headerText="Preço">
                            <h:outputText value="#{item.preco}">
                                <f:convertNumber pattern="R$ 00.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Qtd">
                            <p:spinner id="spinnerQtd"
                                       value="#{item.quantidade}"
                                       min="0" max="20"
                                       widgetVar="spinner_#{item.nome}"/>
                        </p:column>
                        <p:column headerText="Ações">
                            <p:commandButton value="Adicionar"
                                             actionListener="#{pedidoBean.adicionarItem(item)}"
                                             process="@this spinnerQtd"
                                             update=":formPedido:dtPasteis :formPedido:mensagens :formPedido:resumoPedido"
                                             oncomplete="spinner_#{item.nome}.setValue(0)"/>
                        </p:column>
                    </p:dataTable>
                </p:tab>

                <!-- Bebidas -->
                <p:tab title="Bebidas">
                    <p:dataTable id="dtBebidas" value="#{pedidoBean.bebidas}" var="item" styleClass="tabela-produtos">
                        <p:column headerText="Imagem">
                            <p:graphicImage value="#{item.imagem}" style="max-width:70px; border-radius:6px"/>
                        </p:column>
                        <p:column headerText="Nome">#{item.nome}</p:column>
                        <p:column headerText="Descrição">#{item.descricao}</p:column>
                        <p:column headerText="Preço">
                            <h:outputText value="#{item.preco}">
                                <f:convertNumber pattern="R$ 00.00"/>
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Qtd">
                            <p:spinner id="spinnerQtd"
                                       value="#{item.quantidade}"
                                       min="0" max="20"
                                       widgetVar="spinner_#{item.nome}"/>
                        </p:column>
                        <p:column headerText="Ações">
                            <p:commandButton value="Adicionar"
                                             actionListener="#{pedidoBean.adicionarItem(item)}"
                                             process="@this spinnerQtd"
                                             update=":formPedido:dtBebidas :formPedido:mensagens :formPedido:resumoPedido"
                                             oncomplete="spinner_#{item.nome}.setValue(0)"/>
                        </p:column>
                    </p:dataTable>
                </p:tab>

            </p:accordionPanel>

            <h3>Resumo do Pedido</h3>
            <h:panelGroup id="resumoPedido">

                <p:dataTable value="#{pedidoBean.pedido.itens}" var="p" style="width:100%">
                    <p:column headerText="Item">#{p.nome}</p:column>
                    <p:column headerText="Qtd">#{p.quantidade}</p:column>
                    <p:column headerText="Preço">
                        <h:outputText value="#{p.preco}">
                            <f:convertNumber pattern="R$ 00.00"/>
                        </h:outputText>
                    </p:column>
                </p:dataTable>

                <h:outputText value="Total: R$ #{pedidoBean.calcularTotal()}" style="margin-top:10px; font-weight:bold; display:block;" />

                <p:outputLabel for="observacao" value="Observações:" style="margin-top:10px; display:block;"/>
                <p:inputTextarea id="observacao" value="#{pedidoBean.pedido.observacao}" autoResize="true" style="width:100%"/>

            </h:panelGroup>


            <!-- Botão de Finalizar Pedido -->
            <p:commandButton value="Finalizar Pedido"
                             actionListener="#{pedidoBean.finalizarPedido}"
                             update=":formPedido:mensagens"
                             style="margin-top:20px;" />

        </h:form>
    </h:body>
</html>
